{-# LANGUAGE QuasiQuotes #-}
module Example where

import Core
import Text.RawString.QQ

testCore :: Core
testCore = TyApp
  (applyUnderTyLam (local (CoreV evv (CoreProduct [])) (Product [])) coreDump)
  (CoreLit IntTy)

-- Look I can explain, I swear
coreDump :: Core
--coreDump = read [r|TyLam (CoreTV (TV {unTV = 0}) KindType) (TyLam (CoreTV (TV {unTV = 29}) KindType) (Lam (CoreV (V (-1)) (CoreProduct [])) (Lam (CoreV (V 10) (CoreVar (CoreTV (TV {unTV = 0}) KindType))) (NewPrompt (CoreV (V (-2)) (CoreLit IntTy)) (Prompt {prompt_marker = Var (CoreV (V (-2)) (CoreLit IntTy)), prompt_body = App (Lam (CoreV (V (-1)) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))],CoreLit IntTy])) (App (Lam (CoreV (V (-3)) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))],CoreLit IntTy])) (Yield {yield_marker = Project 0 (Var (CoreV (V (-3)) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))],CoreLit IntTy]))), yield_value = Lam (CoreV (V (-4)) (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType)))) (App (App (Project 1 (Project 1 (Var (CoreV (V (-3)) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))],CoreLit IntTy]))))) (Product [])) (Var (CoreV (V (-4)) (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))))))})) (App (Lam (CoreV (V 0) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))],CoreLit IntTy])) (Var (CoreV (V 0) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))],CoreLit IntTy])))) (Var (CoreV (V (-1)) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))],CoreLit IntTy])))))) (App (Lam (CoreV (V 5) (CoreProduct [CoreFun (CoreProduct []) (Open (TV {unTV = 4})) (CoreFun (CoreFun (CoreLit IntTy) (Open (TV {unTV = 4})) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Open (TV {unTV = 4})) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Open (TV {unTV = 4})) (CoreFun (CoreFun (CoreProduct []) (Open (TV {unTV = 4})) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Open (TV {unTV = 4})) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))])) (App (App (Lam (CoreV (V 0) (CoreProduct [])) (Lam (CoreV (V 1) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))],CoreLit IntTy])) (Var (CoreV (V 1) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))],CoreLit IntTy]))))) (App (Lam (CoreV (V 0) (CoreProduct [])) (Product [])) (Var (CoreV (V (-1)) (CoreVar (CoreTV (TV {unTV = 3}) KindRow)))))) (App (App (Lam (CoreV (V 0) (CoreLit IntTy)) (Lam (CoreV (V 1) (CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))])) (Product [Var (CoreV (V 0) (CoreLit IntTy)),Var (CoreV (V 1) (CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))]))]))) (Var (CoreV (V (-2)) (CoreLit IntTy)))) (Var (CoreV (V 5) (CoreProduct [CoreFun (CoreProduct []) (Open (TV {unTV = 4})) (CoreFun (CoreFun (CoreLit IntTy) (Open (TV {unTV = 4})) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Open (TV {unTV = 4})) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreLit IntTy) (Open (TV {unTV = 4})) (CoreFun (CoreFun (CoreProduct []) (Open (TV {unTV = 4})) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Open (TV {unTV = 4})) (CoreVar (CoreTV (TV {unTV = 29}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 29}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 29}) KindType))])))))) (Product [Lam (CoreV (V 2) (CoreVar (CoreTV (TV {unTV = 29}) KindType))) (Var (CoreV (V 2) (CoreVar (CoreTV (TV {unTV = 29}) KindType)))),Lam (CoreV (V (-1)) (CoreProduct [])) (Lam (CoreV (V 2) (CoreProduct [])) (Lam (CoreV (V 1) (CoreFun (CoreProduct []) (Closed (fromList [])) (CoreFun (CoreLit IntTy) (Open (TV {unTV = 5})) (CoreVar (CoreTV (TV {unTV = 29}) KindType))))) (App (App (Var (CoreV (V 1) (CoreFun (CoreProduct []) (Closed (fromList [])) (CoreFun (CoreLit IntTy) (Open (TV {unTV = 5})) (CoreVar (CoreTV (TV {unTV = 29}) KindType)))))) (Var (CoreV (V (-1)) (CoreProduct [])))) (Lit (I 4))))),Lam (CoreV (V (-1)) (CoreProduct [])) (Lam (CoreV (V 3) (CoreLit IntTy)) (Lam (CoreV (V 4) (CoreFun (CoreProduct []) (Closed (fromList [])) (CoreFun (CoreProduct []) (Open (TV {unTV = 5})) (CoreVar (CoreTV (TV {unTV = 29}) KindType))))) (App (App (Var (CoreV (V 4) (CoreFun (CoreProduct []) (Closed (fromList [])) (CoreFun (CoreProduct []) (Open (TV {unTV = 5})) (CoreVar (CoreTV (TV {unTV = 29}) KindType)))))) (Var (CoreV (V (-1)) (CoreProduct [])))) (Product []))))]))})))))|]
--coreDump = read [r|TyLam (CoreTV (TV {unTV = 26}) KindType) (NewPrompt (CoreV (V (-2)) (CoreLit IntTy)) (Prompt {prompt_marker = Var (CoreV (V (-2)) (CoreLit IntTy)), prompt_body = App (Lam (CoreV (V (-1)) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))],CoreLit IntTy])) (App (Lam (CoreV (V (-3)) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))],CoreLit IntTy])) (Yield {yield_marker = Project 1 (Var (CoreV (V (-3)) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))],CoreLit IntTy]))), yield_value = Lam (CoreV (V (-4)) (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType)))) (App (App (Project 1 (Project 0 (Var (CoreV (V (-3)) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))],CoreLit IntTy]))))) (Product [])) (Var (CoreV (V (-4)) (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))))))})) (App (Lam (CoreV (V 0) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))],CoreLit IntTy])) (Var (CoreV (V 0) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))],CoreLit IntTy])))) (Var (CoreV (V (-1)) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))],CoreLit IntTy])))))) (App (Lam (CoreV (V 5) (CoreProduct [CoreFun (CoreProduct []) (Open (TV {unTV = 1})) (CoreFun (CoreFun (CoreLit IntTy) (Open (TV {unTV = 1})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Open (TV {unTV = 1})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Open (TV {unTV = 1})) (CoreFun (CoreFun (CoreProduct []) (Open (TV {unTV = 1})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Open (TV {unTV = 1})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))])) (App (App (Lam (CoreV (V 0) (CoreProduct [])) (Lam (CoreV (V 1) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))],CoreLit IntTy])) (Var (CoreV (V 1) (CoreProduct [CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))],CoreLit IntTy]))))) (App (Lam (CoreV (V 0) (CoreProduct [])) (Product [])) (Var (CoreV (V (-1)) (CoreVar (CoreTV (TV {unTV = 0}) KindRow)))))) (App (App (Lam (CoreV (V 0) (CoreLit IntTy)) (Lam (CoreV (V 1) (CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))])) (Product [Var (CoreV (V 0) (CoreLit IntTy)),Var (CoreV (V 1) (CoreProduct [CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreFun (CoreFun (CoreProduct []) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))]))]))) (Var (CoreV (V (-2)) (CoreLit IntTy)))) (Var (CoreV (V 5) (CoreProduct [CoreFun (CoreProduct []) (Open (TV {unTV = 1})) (CoreFun (CoreFun (CoreLit IntTy) (Open (TV {unTV = 1})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Open (TV {unTV = 1})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreLit IntTy) (Open (TV {unTV = 1})) (CoreFun (CoreFun (CoreProduct []) (Open (TV {unTV = 1})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Open (TV {unTV = 1})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))),CoreFun (CoreVar (CoreTV (TV {unTV = 26}) KindType)) (Closed (fromList [])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))])))))) (Product [Lam (CoreV (V 2) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Var (CoreV (V 2) (CoreVar (CoreTV (TV {unTV = 26}) KindType)))),Lam (CoreV (V (-1)) (CoreProduct [])) (Lam (CoreV (V 2) (CoreProduct [])) (Lam (CoreV (V 1) (CoreFun (CoreProduct []) (Closed (fromList [])) (CoreFun (CoreLit IntTy) (Open (TV {unTV = 2})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))))) (App (App (Var (CoreV (V 1) (CoreFun (CoreProduct []) (Closed (fromList [])) (CoreFun (CoreLit IntTy) (Open (TV {unTV = 2})) (CoreVar (CoreTV (TV {unTV = 26}) KindType)))))) (Var (CoreV (V (-1)) (CoreProduct [])))) (Lit (I 4))))),Lam (CoreV (V (-1)) (CoreProduct [])) (Lam (CoreV (V 3) (CoreLit IntTy)) (Lam (CoreV (V 4) (CoreFun (CoreProduct []) (Closed (fromList [])) (CoreFun (CoreProduct []) (Open (TV {unTV = 2})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))))) (App (App (Var (CoreV (V 4) (CoreFun (CoreProduct []) (Closed (fromList [])) (CoreFun (CoreProduct []) (Open (TV {unTV = 2})) (CoreVar (CoreTV (TV {unTV = 26}) KindType)))))) (Var (CoreV (V (-1)) (CoreProduct [])))) (Product []))))]))}))|]
--coreDump = read [r|TyLam (CoreTV (TV {unTV = 26}) KindType) (NewPrompt (CoreV (V (-2)) (CoreLit IntTy)) (Prompt {prompt_marker = Var (CoreV (V (-2)) (CoreLit IntTy)), prompt_body = Yield {yield_marker = Var (CoreV (V (-2)) (CoreLit IntTy)), yield_value = Lam (CoreV (V (-4)) (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType)))) (App (App (Var (CoreV (V (-4)) (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))))) (Product [Var (CoreV (V (-2)) (CoreLit IntTy)),Product [Lam (CoreV (V 2) (CoreVar (CoreTV (TV {unTV = 26}) KindType))) (Product []),Lam (CoreV (V (-1)) (CoreProduct [])) (Lam (CoreV (V 2) (CoreProduct [])) (Lam (CoreV (V 1) (CoreFun (CoreProduct []) (Closed (fromList [])) (CoreFun (CoreLit IntTy) (Open (TV {unTV = 2})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))))) (App (App (Var (CoreV (V (-4)) (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))))) (Var (CoreV (V (-1)) (CoreProduct [])))) (Lit (I 4))))),Lam (CoreV (V (-1)) (CoreProduct [])) (Lam (CoreV (V 3) (CoreLit IntTy)) (Lam (CoreV (V 4) (CoreFun (CoreProduct []) (Closed (fromList [])) (CoreFun (CoreProduct []) (Open (TV {unTV = 2})) (CoreVar (CoreTV (TV {unTV = 26}) KindType))))) (App (App (Var (CoreV (V 4) (CoreFun (CoreProduct []) (Closed (fromList [])) (CoreFun (CoreProduct []) (Open (TV {unTV = 2})) (CoreVar (CoreTV (TV {unTV = 26}) KindType)))))) (Var (CoreV (V (-1)) (CoreProduct [])))) (Product []))))]])) (Lit (I 4)))}}))|]
coreDump = read [r|TyLam (CoreTV (TV {unTV = 26}) KindType) (NewPrompt (CoreV (V (-2)) (CoreLit IntTy)) (Prompt {prompt_marker = Var (CoreV (V (-2)) (CoreLit IntTy)), prompt_body = Yield {yield_marker = Var (CoreV (V (-2)) (CoreLit IntTy)), yield_value = Lam (CoreV (V (-4)) (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType)))) (App (Var (CoreV (V (-4)) (CoreFun (CoreLit IntTy) (Closed (fromList [("State",ProdTy (RowTy (fromList [("handler",ProdTy (RowTy (fromList [("get",FunTy (ProdTy (RowTy (fromList []))) (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) IntTy),("put",FunTy IntTy (Closed (fromList [("State",ProdTy (RowTy (fromList [])))])) (ProdTy (RowTy (fromList []))))]))),("marker",IntTy)])))])) (CoreVar (CoreTV (TV {unTV = 26}) KindType))))) (Lit (I 4)))}}))|]

applyUnderTyLam f (TyLam a body) = TyLam a (f body)
applyUnderTyLam _ _ = undefined
